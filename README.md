# ResNet50-Implementation
After AlexNet won the ImageNet 2012 competition, every subsequent winning architectures used more number of layers, but the common problem associated with this was vanishing (gradient ~ 0) or exploding (gradient ~ infinite) gradient.

![IMGS/error_graph.jpg](IMGS/error_graph.jpg)

Thus, increasing the number of layers in a Convolutional Neural Network may increase the error rate during the process of training.

## ResNet50 Architecture
In order to solve the problem of vanishing or exploding gradient, Residual Network introduced the concept of **"skip connections"**. The skip connection skips a few layers of the model from getting trained if nothing significant is learnt by those layers. The link to the research paper on Residual Network is [here](https://arxiv.org/pdf/1512.03385.pdf).

![IMGS/ResNet50-Architecture.png](IMGS/ResNet50-Architecture.png)

## Dataset
The dataset for training and validating this ResNet50 model is **Flowers Recognition** dataset, which has been taken from Kaggle. The link for downloading the dataset is [here](https://www.kaggle.com/alxmamaev/flowers-recognition/download). You can download this dataset using linux terminal :
```
curl -O https://www.kaggle.com/alxmamaev/flowers-recognition/download
```
For unziping the .zip file :
```
sudo apt install unzip
unzip archive.zip
```

The dataset contains five different folders, each contains multiple images of the same species of flower. There flower species in the dataset are :
- daisy
- dandelion
- rose
- sunflower
- tulip

## Dependencies

Some packages are required for running the codes in the repository. To install them write the following commands in the terminal :-

```
pip install -r requirements.text
```

Apart from this, we also need to install h5py package to save the weights after training.

```
pip install -q pyyaml h5py
```

## Content of the Repository

- **__pycache__** : _Contains the bytecode generated by the interpreter._
- **flower_photos** : _Contains the images for training, validating and testing our model._
- **IMGS** : _Contains images for README.md file._
- **LICENSE** : _License documentation._
- **README.md** : _Documentation of this repository._
- **dataProcessor.py** - _Code for preprocessing our input data before training our model._
- **modelTrainer.py** - _Code to train the model and save the weights._
- **requirements.txt** - _Used to install dependencies._
- **model.py** - _Code of ResNet50 model written from scratch._

## Result obtained after training model

The model was trained for only 20 epochs, due to system constraints, with a patience of 4 epochs, that is if the loss of the model on the validation dataset does not decrease upto 4 epochs, then the model will stop training. My model stopped training after the 16th epochs. The results obtained are:
- **Training loss** : 0.8213
- **Categorical Accuracy on training data** : 72.90%
- **Validation loss** : 2.0386
- **Categorical Accuracy on validation data** : 53.33%

### [I am facing issue while pushing the Saved weights of the model. That is why the saved model is not available in this repository.]
